<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Prestadores</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="background-overlay"></div>

  <div class="form-container">
    <h2>üë®‚Äç‚öïÔ∏è Gesti√≥n de Prestadores</h2>
    <p>Agreg√° o edit√° tus prestadores y asign√° una sucursal.</p>

    <form (ngSubmit)="isEditing ? updatePrestador() : addPrestador()">

      <ion-item class="input-item">
        <ion-label position="floating">Nombre *</ion-label>
        <ion-input [(ngModel)]="nombre" name="nombre" required></ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label position="floating">DNI (opcional)</ion-label>
        <ion-input [(ngModel)]="usuario_dni" name="usuario_dni"></ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label position="floating">Especialidades</ion-label>
        <ion-input [(ngModel)]="especialidades" name="especialidades"></ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label position="floating">Email</ion-label>
        <ion-input [(ngModel)]="email" name="email" type="email"></ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label position="floating">Tel√©fono</ion-label>
        <ion-input [(ngModel)]="numero_telefono" name="numero_telefono"></ion-input>
      </ion-item>

      <ion-item class="input-item">
        <ion-label>Sucursal</ion-label>
        <ion-select [(ngModel)]="id_sucursal" name="id_sucursal" interface="popover">
          <ion-select-option *ngFor="let s of sucursales" [value]="s.id_sucursal">
            {{ s.nombre }}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <ion-row class="buttons-row">
        <ion-col>
          <ion-button expand="block" color="success" type="submit">
            {{ isEditing ? 'Actualizar' : 'Agregar' }}
          </ion-button>
        </ion-col>
        <ion-col *ngIf="isEditing">
          <ion-button expand="block" fill="outline" color="medium" (click)="cancelEdit()">
            Cancelar
          </ion-button>
        </ion-col>
      </ion-row>
    </form>

    <ion-text color="danger" *ngIf="errorMessage">
      <p>{{ errorMessage }}</p>
    </ion-text>
  </div>

  <!-- Lista de prestadores -->
  <ion-list>
    <ion-item *ngFor="let p of prestadores" class="prestador-item">
      <ion-label>
        <h2>{{ p.nombre }}</h2>
        <p><strong>DNI:</strong> {{ p.usuario_dni || '-' }}</p>
        <p><strong>Especialidad:</strong> {{ p.especialidades || 'No especificada' }}</p>
        <p><strong>Email:</strong> {{ p.email || 'Sin correo' }}</p>
        <p><strong>Tel√©fono:</strong> {{ p.numero_telefono || 'Sin tel√©fono' }}</p>
        <p><strong>Sucursal:</strong> {{ getSucursalNombre(p.id_sucursal) }}</p>
      </ion-label>

      <ion-button fill="clear" color="primary" (click)="editPrestador(p)">
        <ion-icon name="create-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear" color="danger" (click)="deletePrestador(p.id_prestador)">
        <ion-icon name="trash-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>
</ion-content>
